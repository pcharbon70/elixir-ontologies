# Feature: 5.1.1 Protocol Definition Extractor

## Problem Statement

Extract `defprotocol` definitions from Elixir AST. Protocols define a set of functions that can be implemented for different types, enabling polymorphic behavior in Elixir.

## Solution Overview

Create a Protocol extractor module that:
1. Detects `defprotocol` AST patterns
2. Extracts protocol name
3. Extracts protocol functions with their signatures
4. Detects `@fallback_to_any` attribute
5. Extracts documentation (@moduledoc, @doc, @typedoc)

## AST Patterns

### Simple Protocol
```elixir
defprotocol Stringable do
  def to_string(data)
end
# AST: {:defprotocol, meta, [{:__aliases__, _, [:Stringable]}, [do: body]]}
```

### Protocol with Multiple Functions
```elixir
defprotocol Enumerable do
  def count(enumerable)
  def member?(enumerable, element)
  def reduce(enumerable, acc, fun)
end
```

### Protocol with Fallback
```elixir
defprotocol SomeProtocol do
  @fallback_to_any true
  def some_function(data)
end
```

## Technical Details

### Files Created
- `lib/elixir_ontologies/extractors/protocol.ex`

### Key Functions
- `protocol?/1` - Detects defprotocol AST
- `extract/2` - Extracts protocol definition
- `extract!/2` - Extract or raise
- `extract_all/2` - Extract from list of nodes
- `function_names/1` - Get protocol function names
- `get_function/2` - Get specific function by name
- `fallback_to_any?/1` - Check if fallback enabled

### Result Structure
```elixir
%Protocol{
  name: [atom()],           # e.g., [:Enumerable]
  functions: [protocol_function()],
  fallback_to_any: boolean(),
  doc: String.t() | false | nil,
  typedoc: String.t() | nil,
  location: SourceLocation.t() | nil,
  metadata: map()
}
```

## Implementation Plan

- [x] Create `lib/elixir_ontologies/extractors/protocol.ex`
- [x] Detect `defprotocol` AST pattern
- [x] Extract `protocolName`
- [x] Extract protocol functions as `ProtocolFunction`
- [x] Detect `@fallback_to_any` attribute
- [x] Extract @moduledoc and @typedoc
- [x] Write comprehensive tests
- [x] Run tests and dialyzer
- [x] Update phase plan

## Success Criteria

- [x] All defprotocol patterns correctly detected
- [x] Protocol functions extracted with name, arity, parameters
- [x] @fallback_to_any properly detected
- [x] Documentation extracted
- [x] Tests pass (23 doctests + tests)
- [x] Dialyzer clean

## Status

- **Current Step:** Complete
- **Branch:** `feature/phase-5-protocol-extractor` (merged to develop)

## Notes

Task 5.1.1 was implemented together with task 5.1.2 (Protocol Implementation Extractor) in a single comprehensive Protocol module. This design decision:
- Avoids code duplication between definition and implementation extraction
- Keeps all protocol-related functionality in one place
- Allows sharing of helper functions like type name extraction
