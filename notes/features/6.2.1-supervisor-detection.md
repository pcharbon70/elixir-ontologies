# Feature: 6.2.1 Supervisor Detection

## Problem Statement

Phase 6 implements OTP pattern extractors. Task 6.2.1 focuses on detecting modules that implement the Supervisor behaviour, including both standard Supervisor and DynamicSupervisor patterns. This enables analysis of supervision trees.

## Solution Overview

Create a Supervisor extractor module that:
1. Detects `use Supervisor` macro invocations
2. Detects `@behaviour Supervisor` declarations
3. Detects `use DynamicSupervisor` for dynamic supervision
4. Creates appropriate result structs with metadata
5. Links via `implementsOTPBehaviour` relationship

## Supervisor Types

| Type | Detection | Description |
|------|-----------|-------------|
| Supervisor | `use Supervisor` / `@behaviour Supervisor` | Static supervision tree |
| DynamicSupervisor | `use DynamicSupervisor` / `@behaviour DynamicSupervisor` | Dynamic child management |

## Technical Details

### File Location
- `lib/elixir_ontologies/extractors/otp/supervisor.ex` - Main extractor module
- `test/elixir_ontologies/extractors/otp/supervisor_test.exs` - Test file

### Dependencies
- `ElixirOntologies.Extractors.Helpers` - For location extraction, body normalization

### Detection Patterns

```elixir
# Standard Supervisor
{:use, meta, [{:__aliases__, _, [:Supervisor]} | opts]}
{:@, meta, [{:behaviour, _, [{:__aliases__, _, [:Supervisor]}]}]}

# DynamicSupervisor
{:use, meta, [{:__aliases__, _, [:DynamicSupervisor]} | opts]}
{:@, meta, [{:behaviour, _, [{:__aliases__, _, [:DynamicSupervisor]}]}]}
```

### Result Struct

```elixir
%Supervisor{
  supervisor_type: :supervisor | :dynamic_supervisor,
  detection_method: :use | :behaviour,
  use_options: keyword() | nil,
  location: SourceLocation.t() | nil,
  metadata: map()
}
```

## Implementation Plan

- [x] 6.2.1.1 Create `lib/elixir_ontologies/extractors/otp/supervisor.ex` with module structure
- [x] 6.2.1.2 Implement `use Supervisor` detection
- [x] 6.2.1.3 Implement `@behaviour Supervisor` detection
- [x] 6.2.1.4 Implement DynamicSupervisor detection
- [x] 6.2.1.5 Create result struct with supervisor_type field
- [x] 6.2.1.6 Add utility functions (supervisor?/1, supervisor_type/1)
- [x] 6.2.1.7 Write comprehensive tests (51 tests)

## Success Criteria

- [x] Detects `use Supervisor` in module body
- [x] Detects `@behaviour Supervisor` in module body
- [x] Detects `use DynamicSupervisor` in module body
- [x] Distinguishes between Supervisor and DynamicSupervisor
- [x] Extracts use options
- [x] All tests pass (1969 tests)
- [x] Dialyzer clean (0 errors)

## Current Status

- **What works:** Full implementation complete
- **What's next:** Task 6.2.2 - Supervision Strategy Extraction
- **How to run:** `mix test test/elixir_ontologies/extractors/otp/supervisor_test.exs`
