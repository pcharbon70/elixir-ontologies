# Feature: 5.3.1 Struct Definition Extractor

## Problem Statement

Extract `defstruct` definitions from Elixir AST to support struct-related ontology classes. This enables tracking of struct fields, default values, enforced keys, and derived protocols.

## Solution Overview

Create a new `Struct` extractor module that:
1. Detects `defstruct` AST patterns
2. Extracts field names and default values
3. Extracts `@enforce_keys` declarations
4. Leverages existing `Protocol.extract_derives/1` for `@derive` handling
5. Provides utility functions for querying struct information

## AST Patterns

### Simple Struct
```elixir
defstruct [:name, :email, age: 0]
# AST: {:defstruct, meta, [[:name, :email, {:age, 0}]]}
```

### With @enforce_keys
```elixir
@enforce_keys [:name]
defstruct [:name, :email]
# AST: {:@, meta, [{:enforce_keys, _, [[:name]]}]}
```

### With @derive (use existing Protocol.extract_derives/1)
```elixir
@derive [Inspect, {Jason.Encoder, only: [:id]}]
defstruct [:id, :data]
```

## Technical Details

### Files to Create
- `lib/elixir_ontologies/extractors/struct.ex`
- `test/elixir_ontologies/extractors/struct_test.exs`

### Dependencies
- `ElixirOntologies.Extractors.Helpers` - location extraction, body normalization
- `ElixirOntologies.Extractors.Protocol` - reuse `extract_derives/1`

### Key Types

```elixir
@type t :: %__MODULE__{
  fields: [field()],
  enforce_keys: [atom()],
  derives: [Protocol.DeriveInfo.t()],
  location: SourceLocation.t() | nil,
  metadata: map()
}

@type field :: %{
  name: atom(),
  has_default: boolean(),
  default_value: term() | nil,
  location: SourceLocation.t() | nil
}
```

## Implementation Plan

- [x] Create planning document
- [x] Create struct.ex with module structure and types
- [x] Implement `struct?/1` type detection
- [x] Implement `extract/2` for defstruct extraction
- [x] Implement field extraction with defaults
- [x] Implement `extract_enforce_keys/1`
- [x] Integrate with Protocol.extract_derives/1
- [x] Add utility functions (field_names, enforced?, has_default?)
- [x] Write comprehensive tests
- [x] Run tests and dialyzer
- [x] Update phase plan
- [x] Write summary

## Success Criteria

- [x] All defstruct patterns correctly detected
- [x] Fields extracted with name and default status
- [x] @enforce_keys correctly linked to fields
- [x] @derive correctly extracted (via Protocol module)
- [x] Tests pass (26 doctests + 41 unit tests)
- [x] Dialyzer clean
- [x] API consistent with Protocol and Behaviour extractors

## Status

- **Current Step:** Complete
- **Branch:** `feature/5.3.1-struct-definition-extractor`
