# Feature: 6.1.1 GenServer Detection

## Problem Statement

Phase 6 introduces OTP pattern extractors. Task 6.1.1 focuses on detecting modules that implement GenServer behaviour, which is fundamental to building supervision trees and stateful processes in Elixir/OTP applications.

## Solution Overview

Create a new GenServer extractor module that:
1. Detects `use GenServer` macro invocations
2. Detects `@behaviour GenServer` declarations
3. Creates a `GenServerImplementation` result struct with relevant metadata
4. Links via `implementsOTPBehaviour` relationship

## Technical Details

### File Location
- `lib/elixir_ontologies/extractors/otp/genserver.ex` - Main extractor module
- `test/elixir_ontologies/extractors/otp/genserver_test.exs` - Test file

### Dependencies
- `ElixirOntologies.Extractors.Helpers` - For location extraction, body normalization
- `ElixirOntologies.Extractors.Behaviour` - For @behaviour detection patterns

### Detection Patterns

1. **`use GenServer`** pattern:
   ```elixir
   {:use, meta, [{:__aliases__, _, [:GenServer]} | opts]}
   {:use, meta, [GenServer | opts]}  # bare atom form
   ```

2. **`@behaviour GenServer`** pattern:
   ```elixir
   {:@, meta, [{:behaviour, _, [{:__aliases__, _, [:GenServer]}]}]}
   {:@, meta, [{:behaviour, _, [GenServer]}]}  # bare atom form
   ```

### Result Struct

```elixir
%GenServerImplementation{
  detection_method: :use | :behaviour,
  use_options: keyword() | nil,  # options passed to use GenServer
  location: SourceLocation.t() | nil,
  metadata: map()
}
```

## Implementation Plan

- [x] 6.1.1.1 Create `lib/elixir_ontologies/extractors/otp/genserver.ex` with module structure
- [x] 6.1.1.2 Implement `use GenServer` detection
- [x] 6.1.1.3 Implement `@behaviour GenServer` detection
- [x] 6.1.1.4 Create `GenServerImplementation` result struct
- [x] 6.1.1.5 Add utility functions (genserver?/1, detection_method/1)
- [x] 6.1.1.6 Write comprehensive tests (39 tests)

## Success Criteria

- [x] Detects `use GenServer` in module body
- [x] Detects `@behaviour GenServer` in module body
- [x] Distinguishes between detection methods
- [x] Extracts use options (e.g., `use GenServer, restart: :transient`)
- [x] All tests pass (741 doctests + 23 properties + 1888 tests)
- [x] Dialyzer clean (0 errors)

## Current Status

- **What works:** Full GenServer detection implemented
- **What's next:** Task 6.1.2 - GenServer Callback Extraction
- **How to run:** `mix test test/elixir_ontologies/extractors/otp/genserver_test.exs`
