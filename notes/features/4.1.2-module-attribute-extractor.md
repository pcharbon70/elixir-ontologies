# Feature: Task 4.1.2 - Module Attribute Extractor

## Overview

Create an attribute extractor that extracts Elixir module attributes from AST, classifying them into appropriate types based on their purpose (documentation, deprecation, compilation options, behaviour declarations, etc.).

## Problem Statement

Module attributes in Elixir serve multiple purposes: documentation, compile-time configuration, deprecation notices, and behaviour declarations. The extractor needs to:
1. Extract all module attributes with their names and values
2. Classify special attributes into appropriate subtypes
3. Preserve attribute metadata (location, association with functions)

## Ontology Classes to Support

From `elixir-structure.ttl`:
- `ModuleAttribute` - Base class with `attributeName`, `attributeValue`
- `DocAttribute` - Subtype for `@doc`, `@moduledoc`, `@typedoc`
- `DeprecatedAttribute` - For `@deprecated` with message
- `SinceAttribute` - For `@since` with version
- `ExternalResourceAttribute` - For `@external_resource`
- `CompileAttribute` - For `@compile`
- `BehaviourDeclaration` - For `@behaviour`/`@behavior`

## Implementation Plan

### Step 1: Create Attribute Extractor Module
- [x] Create `lib/elixir_ontologies/extractors/attribute.ex`
- [x] Define `Attribute` result struct with fields: type, name, value, location, metadata
- [x] Add type detection: `attribute?/1`

### Step 2: Implement Attribute.extract/2
- [x] Accept AST node and optional context
- [x] Return `{:ok, %Attribute{}}` or `{:error, reason}`
- [x] Add `extract!/2` that raises on error

### Step 3: Extract Generic Attributes
- [x] Parse `{:@, meta, [{name, _, [value]}]}` pattern
- [x] Store attribute name as atom
- [x] Store attribute value (may be complex AST)

### Step 4: Classify Documentation Attributes
- [x] Detect `@doc` as `:doc_attribute` type
- [x] Detect `@moduledoc` as `:moduledoc_attribute` type
- [x] Detect `@typedoc` as `:typedoc_attribute` type
- [x] Handle string, heredoc, and `false` values
- [x] Store `hidden: true` when value is `false`

### Step 5: Extract Deprecation Attributes
- [x] Detect `@deprecated` as `:deprecated_attribute` type
- [x] Extract deprecation message
- [x] Store in metadata for linking to function

### Step 6: Extract Version Attributes
- [x] Detect `@since` as `:since_attribute` type
- [x] Extract version string

### Step 7: Extract Compile Attributes
- [x] Detect `@external_resource` as `:external_resource_attribute` type
- [x] Detect `@compile` as `:compile_attribute` type
- [x] Extract compile options

### Step 8: Extract Behaviour Declarations
- [x] Detect `@behaviour` and `@behavior` as `:behaviour_declaration` type
- [x] Extract the behaviour module
- [x] Store for `implementsBehaviour` relationship

### Step 9: Bulk Extraction Helper
- [x] Add `extract_all/1` to extract all attributes from module body
- [x] Group by type for easy access
- [x] Maintain order for documentation association

### Step 10: Write Tests
- [x] Test generic attribute extraction
- [x] Test doc attribute classification
- [x] Test @deprecated extraction
- [x] Test @since extraction
- [x] Test @external_resource extraction
- [x] Test @compile extraction
- [x] Test @behaviour extraction
- [x] Test extract_all/1

## Result Struct Design

```elixir
%Attribute{
  type: :attribute | :doc_attribute | :moduledoc_attribute | :typedoc_attribute |
        :deprecated_attribute | :since_attribute | :external_resource_attribute |
        :compile_attribute | :behaviour_declaration,
  name: atom(),
  value: term(),
  location: SourceLocation.t() | nil,
  metadata: %{
    hidden: boolean() | nil,  # for @doc false
    message: String.t() | nil,  # for @deprecated
    version: String.t() | nil,  # for @since
    module: [atom()] | atom() | nil  # for @behaviour
  }
}
```

## Success Criteria

- [x] All 9 subtasks from plan completed
- [x] At least 14 tests passing (as specified in plan) - 72 tests (20 doctests + 52 unit tests)
- [x] Doctests for all public functions
- [x] Dialyzer passes with no errors
- [x] Consistent with Module extractor patterns

## Files to Create/Modify

### Create
- `lib/elixir_ontologies/extractors/attribute.ex` - Main attribute extractor
- `test/elixir_ontologies/extractors/attribute_test.exs` - Test file

### Modify
- `notes/planning/phase-04.md` - Mark task 4.1.2 complete

## Status

- **Current Step:** Complete
- **Tests:** 72 tests (20 doctests + 52 unit tests), 0 failures
- **Dialyzer:** Passes with 0 errors
