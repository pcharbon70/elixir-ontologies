# Feature 1.4.1: Graph Module

## Problem Statement

The project needs a Graph wrapper module that provides a clean, domain-specific API for creating, manipulating, and querying RDF graphs. While RDF.ex provides the underlying functionality, we need a higher-level API that:
- Integrates with our namespace definitions
- Provides convenient methods for common operations
- Wraps RDF.Graph with ElixirOntologies-specific functionality

## Solution Overview

Create an `ElixirOntologies.Graph` module that:
1. Wraps `RDF.Graph` in a struct for extensibility
2. Provides CRUD operations (new, add, add_all, merge)
3. Provides query operations (subjects, describe)
4. Supports SPARQL queries when the sparql library is available

## Technical Details

### File Location
`lib/elixir_ontologies/graph.ex`

### Struct Definition
```elixir
defstruct [:graph, :base_iri]
```

### Dependencies
- `RDF.Graph` from rdf library
- `SPARQL` (optional) for query support
- `ElixirOntologies.NS` for prefix resolution

### API Design

| Function | Description |
|----------|-------------|
| `new/0`, `new/1` | Create empty graph with optional base IRI |
| `add/2` | Add single statement (triple or quad) |
| `add_all/2` | Add multiple statements |
| `merge/2` | Combine two graphs |
| `subjects/1` | Return all subjects in graph |
| `describe/2` | Return all triples for a subject |
| `query/2` | Execute SPARQL query (when available) |

## Implementation Plan

- [x] 1.4.1.1 Create module with struct definition
- [x] 1.4.1.2 Implement `Graph.new/0` and `Graph.new/1`
- [x] 1.4.1.3 Implement `Graph.add/2`
- [x] 1.4.1.4 Implement `Graph.add_all/2`
- [x] 1.4.1.5 Implement `Graph.merge/2`
- [x] 1.4.1.6 Implement `Graph.subjects/1`
- [x] 1.4.1.7 Implement `Graph.describe/2`
- [x] 1.4.1.8 Implement `Graph.query/2` with SPARQL detection
- [x] 1.4.1.9 Write comprehensive tests (52 tests - 39 tests + 13 doctests)

## Success Criteria

- [x] All functions implemented with proper typespecs
- [x] Comprehensive documentation with examples
- [x] 15+ tests covering all operations (52 tests)
- [x] SPARQL query works when library available
- [x] Clean integration with existing NS module

## Current Status

**Status**: Complete

### What Works
- Feature branch created: `feature/1.4.1-graph-module`
- Planning document created
- Graph module fully implemented with all functions
- 52 tests passing (39 unit tests + 13 doctests)
- SPARQL query support with automatic prefix declarations

### Additional Features Implemented
- `Graph.statement_count/1` - returns number of statements
- `Graph.empty?/1` - checks if graph is empty
- `Graph.to_rdf_graph/1` - extracts underlying RDF.Graph
- `Graph.from_rdf_graph/2` - creates Graph from RDF.Graph
