# Summary: 5.2.1 Behaviour Definition Extractor

## Overview

Implemented the Behaviour Definition Extractor that extracts `@callback`, `@macrocallback`, and `@optional_callbacks` from Elixir modules that define behaviours.

## Implementation

### Files Created

1. **`lib/elixir_ontologies/extractors/behaviour.ex`** (~420 LOC)
   - Main extractor module for behaviour definitions
   - Extracts callback specifications with full type information

2. **`test/elixir_ontologies/extractors/behaviour_test.exs`** (~515 LOC)
   - Comprehensive test coverage
   - 58 tests total (20 doctests + 38 unit tests)

### Key Features

**Type Detection:**
- `callback?/1` - Detects `@callback` attributes
- `macrocallback?/1` - Detects `@macrocallback` attributes
- `optional_callbacks?/1` - Detects `@optional_callbacks` declarations
- `defines_behaviour?/1` - Checks if module body defines a behaviour

**Extraction Functions:**
- `extract_callback/1` - Extracts single callback from AST node
- `extract_callback!/1` - Bang version that raises on error
- `extract_from_body/1` - Extracts all callbacks from module body

**Utility Functions:**
- `callback_names/1` - Lists all callback and macrocallback names
- `required_callback_names/1` - Lists only required callbacks
- `optional_callback_names/1` - Lists only optional callbacks
- `get_callback/2` - Finds callback by name
- `optional?/3` - Checks if callback is optional by name/arity

### Data Structures

**Behaviour struct:**
```elixir
%Behaviour{
  callbacks: [%Callback{}],      # @callback definitions
  macrocallbacks: [%Callback{}], # @macrocallback definitions
  optional_callbacks: [],        # [{name, arity}, ...]
  doc: nil,                      # @moduledoc content
  metadata: %{}
}
```

**Callback struct:**
```elixir
%Callback{
  name: atom(),
  arity: non_neg_integer(),
  type: :callback | :macrocallback,
  spec: term(),        # Full typespec AST
  return_type: term(), # Return type AST
  parameters: [],      # Parameter type specs
  is_optional: false,
  doc: nil,
  location: nil
}
```

### AST Patterns

```elixir
# @callback
{:@, meta, [{:callback, _, [{:"::", _, [head, return_type]}]}]}

# @macrocallback
{:@, meta, [{:macrocallback, _, [{:"::", _, [head, return_type]}]}]}

# @optional_callbacks
{:@, meta, [{:optional_callbacks, _, [[name: arity, ...]]}]}
```

## Test Results

```
58 tests, 0 failures
```

Test categories:
- Type detection tests (callback?, macrocallback?, optional_callbacks?)
- Single callback extraction tests
- Module body extraction tests
- Utility function tests
- Real-world behaviour tests (GenServer, Plug patterns)

## Technical Notes

1. **Doc Attribution**: `@doc` attributes are tracked and applied only to the immediately following callback, matching Elixir's semantics.

2. **Optional Callback Marking**: Callbacks listed in `@optional_callbacks` are marked with `is_optional: true` during body extraction.

3. **Dialyzer Suppression**: Added `@dialyzer {:nowarn_function, extract_callback!: 1}` to suppress a false positive where dialyzer incorrectly inferred the function could only receive error tuples.

## Task Checklist

- [x] 5.2.1.1 Create `lib/elixir_ontologies/extractors/behaviour.ex`
- [x] 5.2.1.2 Detect modules with `@callback` as `Behaviour`
- [x] 5.2.1.3 Extract `@callback` as `RequiredCallback`
- [x] 5.2.1.4 Extract `@optional_callbacks` items as `OptionalCallback`
- [x] 5.2.1.5 Extract `@macrocallback` as `MacroCallback`
- [x] 5.2.1.6 Link via `definesCallback`
- [x] 5.2.1.7 Create `CallbackSpec` for callback type signatures
- [x] 5.2.1.8 Write behaviour definition tests (success: 20 doctests + 38 unit tests)

## Next Task

**Task 5.2.2: Behaviour Implementation Extractor** - Extract `@behaviour` declarations and match implemented functions to callbacks.
