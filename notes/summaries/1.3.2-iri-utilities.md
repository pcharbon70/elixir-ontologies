# Summary: Task 1.3.2 - IRI Utilities

## Overview

Extended the `ElixirOntologies.IRI` module with utility functions for parsing, validation, and component extraction from IRIs. This enables round-trip operations (generate → use → parse) and validation of IRI integrity.

## Changes Made

### Extended Module: `lib/elixir_ontologies/iri.ex`

Added 5 new public functions:

1. **`valid?/1`** - Validates IRI format (delegates to `RDF.IRI.valid?/1`)
2. **`parse/1`** - Parses any supported IRI into a component map with type detection
3. **`module_from_iri/1`** - Extracts module name from module/function/clause/parameter IRIs
4. **`function_from_iri/1`** - Extracts `{module, name, arity}` from function/clause/parameter IRIs
5. **`unescape_name/1`** - Inverse of `escape_name/1` for URL-decoded names

### Parse Result Structure

```elixir
%{
  type: :module | :function | :clause | :parameter | :file | :location | :repository | :commit,
  base_iri: "https://example.org/code#",
  # Type-specific fields depending on IRI type
}
```

### Supported IRI Types

| Type | Pattern | Example |
|------|---------|---------|
| Module | `base#Module.Name` | `base#MyApp.Users` |
| Function | `base#Module/func/arity` | `base#MyApp/get/1` |
| Clause | `.../clause/N` | `base#MyApp/get/1/clause/0` |
| Parameter | `.../param/N` | `base#MyApp/get/1/clause/0/param/0` |
| File | `base#file/path` | `base#file/lib/users.ex` |
| Location | `.../L{start}-{end}` | `base#file/lib/users.ex/L10-25` |
| Repository | `base#repo/hash` | `base#repo/a1b2c3d4` |
| Commit | `.../commit/sha` | `base#repo/a1b2c3d4/commit/abc123` |

## Test Coverage

Added 43 new tests covering:
- `valid?/1` validation (3 tests)
- `unescape_name/1` (5 tests)
- `parse/1` for all IRI types (14 tests)
- `module_from_iri/1` (6 tests)
- `function_from_iri/1` (6 tests)
- Round-trip tests: generate → parse → verify (12 tests)

**Total tests: 88** (45 from task 1.3.1 + 43 new)

## Usage Examples

```elixir
alias ElixirOntologies.IRI

# Validate IRI
IRI.valid?(RDF.iri("https://example.org/code#MyApp"))
#=> true

# Parse IRI into components
{:ok, result} = IRI.parse(RDF.iri("https://example.org/code#MyApp/get/1"))
result.type      #=> :function
result.module    #=> "MyApp"
result.function  #=> "get"
result.arity     #=> 1

# Extract module name (works for module, function, clause, parameter IRIs)
{:ok, "MyApp.Users"} = IRI.module_from_iri("https://example.org/code#MyApp.Users/get/1")

# Extract function signature
{:ok, {"MyApp", "valid?", 1}} = IRI.function_from_iri("https://example.org/code#MyApp/valid%3F/1")

# Unescape URL-encoded characters
IRI.unescape_name("valid%3F")  #=> "valid?"
```

## Files Changed

- `lib/elixir_ontologies/iri.ex` - Added utility functions
- `test/elixir_ontologies/iri_test.exs` - Added 43 tests
- `notes/planning/phase-01.md` - Marked task 1.3.2 complete
- `notes/features/1.3.2-iri-utilities.md` - Updated status to complete

## How to Test

```bash
mix test test/elixir_ontologies/iri_test.exs
```
