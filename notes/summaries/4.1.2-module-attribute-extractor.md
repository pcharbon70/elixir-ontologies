# Summary: Task 4.1.2 - Module Attribute Extractor

## Overview

Implemented a comprehensive Attribute extractor for Phase 4 that extracts Elixir module attributes from AST, classifying them into appropriate types based on their purpose.

## Files Created

### `lib/elixir_ontologies/extractors/attribute.ex` (~450 lines)

Main extractor module with:

**Result Struct:**
```elixir
%Attribute{
  type: :attribute | :doc_attribute | :moduledoc_attribute | :typedoc_attribute |
        :deprecated_attribute | :since_attribute | :external_resource_attribute |
        :compile_attribute | :behaviour_declaration | :callback_attribute |
        :optional_callbacks_attribute | :derive_attribute | :enforce_keys_attribute |
        :impl_attribute | :dialyzer_attribute | :on_load_attribute |
        :on_definition_attribute | :before_compile_attribute |
        :after_compile_attribute | :vsn_attribute,
  name: atom(),
  value: term(),
  location: SourceLocation.t() | nil,
  metadata: %{...}  # Type-specific metadata
}
```

**Public API:**
- `attribute?/1` - Type detection for attribute AST nodes
- `extract/2` - Main extraction function
- `extract!/2` - Raising variant
- `extract_all/1` - Bulk extraction from module body
- `doc_attribute?/1` - Check if attribute is documentation
- `hidden?/1` - Check if documentation is hidden (`@doc false`)
- `behaviour?/1` - Check if attribute is a behaviour declaration
- `behaviour_module/1` - Get the behaviour module name

**Attribute Types Supported:**

| Category | Attributes | Type |
|----------|------------|------|
| Documentation | `@doc`, `@moduledoc`, `@typedoc` | `*_attribute` |
| Deprecation | `@deprecated` | `:deprecated_attribute` |
| Version | `@since` | `:since_attribute` |
| Compilation | `@external_resource`, `@compile` | `*_attribute` |
| Behaviour | `@behaviour`, `@behavior` | `:behaviour_declaration` |
| Callbacks | `@callback`, `@optional_callbacks` | `*_attribute` |
| Struct | `@derive`, `@enforce_keys` | `*_attribute` |
| Implementation | `@impl` | `:impl_attribute` |
| Dialyzer | `@dialyzer` | `:dialyzer_attribute` |
| Lifecycle | `@on_load`, `@before_compile`, `@after_compile` | `*_attribute` |
| Version | `@vsn` | `:vsn_attribute` |

**Type-Specific Metadata:**
- Doc attributes: `hidden: boolean()`
- Deprecated: `message: String.t() | nil`
- Since: `version: String.t() | nil`
- Behaviour: `module: [atom()] | atom() | nil`
- External resource: `path: String.t() | nil`
- Compile: `options: term()`
- Impl: `value: term()`
- Enforce keys: `keys: [atom()]`
- Derive: `protocols: list()`

### `test/elixir_ontologies/extractors/attribute_test.exs` (~460 lines)

Comprehensive test coverage:
- Type detection tests (`attribute?/1`)
- Generic attribute extraction tests
- Documentation attribute tests (doc, moduledoc, typedoc, hidden)
- Deprecation attribute tests
- Since attribute tests
- External resource attribute tests
- Compile attribute tests
- Behaviour attribute tests (UK/US spelling, nested modules, erlang modules)
- Other attribute type tests (callback, impl, derive, enforce_keys, dialyzer, lifecycle)
- Bulk extraction tests (`extract_all/1`)
- `extract!/2` tests
- Integration tests with `quote`

## Key Implementation Details

1. **Comprehensive Classification:** 20+ attribute types are recognized and classified appropriately.

2. **Metadata Extraction:** Type-specific metadata is extracted and stored (e.g., deprecation message, version string, behaviour module).

3. **Hidden Documentation:** `@doc false`, `@moduledoc false` are detected with `hidden: true` metadata.

4. **US/UK Spelling:** Both `@behaviour` and `@behavior` are supported.

5. **Erlang Modules:** Behaviour declarations with erlang atoms (e.g., `:gen_server`) are properly handled.

6. **Bulk Extraction:** `extract_all/1` extracts all attributes from a module body while maintaining order.

## Test Results

- **Total Tests:** 72 (20 doctests + 52 unit tests)
- **Failures:** 0
- **Dialyzer:** Passes with 0 errors
- **Full Suite:** 1568 tests (397 doctests + 23 properties + 1148 tests), 0 failures

## Ontology Alignment

Supports the following from `elixir-structure.ttl`:
- `ModuleAttribute` - Base class with `attributeName`, `attributeValue`
- `DocAttribute` - For `@doc`, `@moduledoc`, `@typedoc`
- `DeprecatedAttribute` - For `@deprecated` with message
- `SinceAttribute` - For `@since` with version
- `ExternalResourceAttribute` - For `@external_resource`
- `CompileAttribute` - For `@compile`
- `BehaviourDeclaration` - For `@behaviour`/`@behavior`

## Next Steps

Task 4.2.1 - Function Definition Extractor:
- Create `lib/elixir_ontologies/extractors/function.ex`
- Extract `functionName` from def/defp AST
- Calculate `arity` from parameter count
- Classify as `PublicFunction` (def) or `PrivateFunction` (defp)
- Detect `GuardFunction` (defguard/defguardp)
- Detect `DelegatedFunction` (defdelegate) with `delegatesTo`
