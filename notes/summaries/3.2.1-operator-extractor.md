# Summary: Task 3.2.1 - Operator Extractor Module

## Overview

Implemented the Operator extractor module that analyzes Elixir AST nodes representing operator expressions and extracts their type classification, operands, and metadata. This covers all 9 operator categories defined in elixir-core.ttl.

## Implementation

### Module: `ElixirOntologies.Extractors.Operator`

Location: `lib/elixir_ontologies/extractors/operator.ex`

### Result Struct

```elixir
%Operator{
  type: :arithmetic | :comparison | :logical | :pipe | :match |
        :capture | :string_concat | :list | :in,
  operator_class: :UnaryOperator | :BinaryOperator,
  symbol: atom(),           # :+, :==, :|>, etc.
  arity: 1 | 2,
  operands: %{
    left: Macro.t() | nil,  # Binary operators
    right: Macro.t() | nil,
    operand: Macro.t() | nil  # Unary operators
  },
  location: SourceLocation.t() | nil,
  metadata: map()
}
```

### Supported Operator Categories (9 total)

| Type | Operators | Ontology Class |
|------|-----------|----------------|
| Arithmetic | `+`, `-`, `*`, `/`, `div`, `rem` | `core:ArithmeticOperator` |
| Comparison | `==`, `!=`, `===`, `!==`, `<`, `>`, `<=`, `>=` | `core:ComparisonOperator` |
| Logical | `and`, `or`, `not`, `&&`, `\|\|`, `!` | `core:LogicalOperator` |
| Pipe | `\|>` | `core:PipeOperator` |
| Match | `=` | `core:MatchOperator` |
| Capture | `&` | `core:CaptureOperator` |
| String Concat | `<>` | `core:StringConcatOperator` |
| List | `++`, `--` | `core:ListOperator` |
| Membership | `in` | `core:InOperator` |

### Key Functions

- `operator?/1` - Check if AST node is an operator expression
- `operator_type/1` - Get operator type classification
- `operator_class/2` - Get `:UnaryOperator` or `:BinaryOperator`
- `unary?/1`, `binary?/1` - Check operator arity
- `extract/1` - Extract operator with `{:ok, result}` / `{:error, reason}`
- `extract!/1` - Extract operator, raising on error
- `symbol_string/1` - Convert operator atom to string
- `operators_of_type/1` - Get all operators of a given type
- `all_operators/0` - Get all known operator symbols

### Metadata Fields

- `symbol_string` - String representation of the operator
- `is_shortcircuit` - Boolean for `and`, `or`, `&&`, `||`
- `strict_boolean` - Boolean for `and`, `or`, `not` (strict boolean operators)
- `capture_type` - `:function_capture` for `&` operator

### Edge Cases Handled

1. **Dual-purpose `-`**: Can be unary (negation) or binary (subtraction)
   - Unary: `{:-, meta, [operand]}`
   - Binary: `{:-, meta, [left, right]}`

2. **Capture operator `&`**: Complex nested structures
   - `&Mod.fun/2` - Remote function capture
   - `&(&1 + &2)` - Anonymous function with placeholders
   - `&foo/1` - Local function capture

3. **Logical operators**: Different semantics between strict and non-strict
   - `and`, `or`, `not` - Only accept boolean values
   - `&&`, `||`, `!` - Accept any truthy/falsy values

## Test Results

- **92 total tests** (35 doctests + 57 unit tests)
- All tests pass with no warnings
- Full test suite: **891 tests** (217 doctests + 674 tests), 0 failures

### Test Coverage by Category

| Category | Test Count |
|----------|------------|
| Arithmetic | 7 |
| Comparison | 8 |
| Logical | 6 |
| Pipe | 2 |
| Match | 2 |
| Capture | 3 |
| String Concat | 2 |
| List | 2 |
| In | 1 |
| Type Detection | 9 |
| Helper Functions | 8 |
| Error Handling | 5 |
| Metadata | 4 |
| Location | 2 |

## Files Created/Modified

### Created
- `lib/elixir_ontologies/extractors/operator.ex` - Main module (~450 lines)
- `test/elixir_ontologies/extractors/operator_test.exs` - Test file (~600 lines)
- `notes/features/3.2.1-operator-extractor.md` - Planning document
- `notes/summaries/3.2.1-operator-extractor.md` - This summary

### Modified
- `notes/planning/phase-03.md` - Marked task 3.2.1 as complete

## Design Decisions

1. **Classification Constants**: All operators are defined as module attributes for quick lookup and easy maintenance.

2. **Dual Arity Handling**: Operators like `-` that can be unary or binary are handled by checking args length.

3. **Operands Map Structure**: Binary operators use `left`/`right` keys, unary use `operand` key for clear semantics.

4. **Metadata Enrichment**: Type-specific metadata (strict_boolean, is_shortcircuit) aids downstream processing.

5. **Full Node for Location**: Location extraction requires the full AST node, not just metadata, to work with the Location module.

## Integration with Ontology

The module aligns with elixir-core.ttl classes:
- `OperatorExpression` (parent class)
- `UnaryOperator`, `BinaryOperator` (structural classes)
- `ArithmeticOperator`, `ComparisonOperator`, `LogicalOperator`, etc. (type classes)

Properties:
- `core:operatorSymbol` - string representation
- `core:hasLeftOperand`, `core:hasRightOperand` - binary operator operands
- `core:hasOperand` - unary operator operand

## Next Steps

- Task 3.3.1: Pattern Extractor Module (11 pattern types)
