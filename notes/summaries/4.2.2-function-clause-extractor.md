# Summary: Task 4.2.2 - Function Clause Extractor

## Overview

Implemented a comprehensive Function Clause extractor for Phase 4 that extracts individual function clauses from AST, including clause ordering, function head (parameters, guards), function body, and support for multi-clause functions.

## Files Created

### `lib/elixir_ontologies/extractors/clause.ex` (~340 lines)

Main extractor module with:

**Result Struct:**
```elixir
%Clause{
  name: atom(),
  arity: non_neg_integer(),
  visibility: :public | :private,
  order: pos_integer(),
  head: %{
    parameters: [Macro.t()],
    guard: Macro.t() | nil
  },
  body: Macro.t() | nil,
  location: SourceLocation.t() | nil,
  metadata: %{
    function_type: :def | :defp,
    has_guard: boolean(),
    bodyless: boolean()
  }
}
```

**Public API:**
- `clause?/1` - Type detection for function clause AST nodes
- `extract/2` - Main extraction with `:order` option
- `extract!/2` - Raising variant
- `extract_all/1` - Bulk extraction from module body
- `group_clauses/1` - Group clauses by `{name, arity}`
- `assign_order/1` - Assign sequential order to clause list
- `clause_id/1` - Returns "name/arity#order" string
- `has_guard?/1` - Check if clause has a guard
- `bodyless?/1` - Check if clause has no body
- `parameter_count/1` - Get number of parameters

**Features:**
- Individual clause extraction from def/defp AST
- Function head extraction (parameters and guard)
- Function body extraction (supports `do:` and `do...end` forms)
- Bodyless clause support (for protocol definitions)
- Clause ordering (1-indexed)
- Grouping by name/arity for multi-clause functions
- Bulk extraction from module body

### `test/elixir_ontologies/extractors/clause_test.exs` (~350 lines)

Comprehensive test coverage:
- Type detection tests (`clause?/1`)
- Basic clause extraction tests
- Guard clause tests
- Bodyless clause tests
- Body extraction tests
- Bulk extraction tests (`extract_all/1`)
- Grouping tests (`group_clauses/1`)
- Order assignment tests
- Helper function tests
- Error handling tests
- Integration tests with `quote`

## Key Implementation Details

1. **Clause Ordering:** Clauses are assigned order based on their position in the module body. The `group_clauses/1` function re-orders within groups.

2. **Head Structure:** The head contains both `parameters` (list of parameter ASTs) and `guard` (guard expression or nil).

3. **Body Extraction:** Handles multiple body formats:
   - `[do: expr]` - Single expression
   - `[{:do, expr} | _rest]` - With other clauses (else, etc.)
   - `nil` - Bodyless (protocol definitions)

4. **Grouping:** `group_clauses/1` groups by `{name, arity}` tuple and assigns proper order within each group.

5. **Pattern Matching Order:** Like the Function extractor, guarded patterns must come before unguarded patterns to match correctly.

## Test Results

- **Total Tests:** 60 (20 doctests + 40 unit tests)
- **Failures:** 0
- **Dialyzer:** Passes with 0 errors
- **Full Suite:** 1708 tests (445 doctests + 23 properties + 1240 tests), 0 failures

## Ontology Alignment

Supports the following from `elixir-structure.ttl`:
- `FunctionClause` - Individual clause with `clauseOrder`
- `FunctionHead` - Parameters and guards
- `FunctionBody` - The expression(s) in the clause

## Relationship to Function Extractor

The Clause extractor complements the Function extractor (4.2.1):
- **Function extractor:** Extracts function identity and metadata (name, arity, visibility, doc, spec)
- **Clause extractor:** Extracts individual clauses with their structure (parameters, guards, body)

Together, they enable full function analysis including multi-clause pattern matching.

## Next Steps

Task 4.2.3 - Parameter Extractor:
- Extract each parameter as `Parameter` instance
- Set `parameterPosition` (0-indexed)
- Extract `parameterName` when simple variable
- Detect `DefaultParameter` with `hasDefaultValue`
- Detect `PatternParameter` for destructuring parameters
- Link to pattern via `hasPatternExpression`
